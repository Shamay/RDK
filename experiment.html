<! doctype html>
<html>
	<head>
		<title> RDK Experiment</title>
		 <script src = "https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
		 <script src = "jspsych-5.0.3/jspsych.js"></script>
		 <script src = "jspsych-5.0.3/plugins/jspsych-RDK.js"></script> <!--Include the script for the RDK plugin-->
		 <script src = "jspsych-5.0.3/plugins/jspsych-text.js"></script>
		 <link href = "jspsych-5.0.3/css/jspsych.css" rel = "stylesheet" type = "text/css"></link>
	</head>
	<body>
	</body>
	<script>
		
		
		//---------Create instructions---------
		
		var instructions_block = {
			type: "text",
			text: "<p> This is a sample experiment for the RDK plugin.</p>" + 
			"<p> On each trial, half the dots will be moving in a coherent direction (left or right) and the other half will move randomly.</p>" + 
			"<p> Before the end of the trial, determine if the dots are moving left or right.</p>" + 
			"<p> If the dots are moving left, press the 'A' key. If the dots are moving right, press the 'L' key.</p>" +
			"<p> There are 4 trials and each trial will last 1000ms.</p>" +
			"<p> After all 4 trials have ended, the data will be displayed on the screen and a copy will be saved locally in a .csv file.</p>"  +
			"<p> Press any key to continue.</p>"			
		}
		
		
		
		//---------Create trials---------
		
		//Create an array of 2 different trials (different conditions)
		var RDK_trial = [
			{//First trial
				correct_choice: "a", //The correct answer for this trial
				coherent_direction: 180 //The coherent direction for this trial
			},
			{//Second trial
				correct_choice: "l", //The correct answer for this trial
				coherent_direction: 0 //The coherent direction for this trial
			},
		];
		
		//Multiply based on how many trials you need and randomize the trial order
		var all_trials = jsPsych.randomization.repeat(RDK_trial,2); //Double the number of trials and shuffle them
		
		//The test block where all the trials are nested. The properties here will trickle down to all trials in the timeline unless they have their own properties defined		
		var test_block = {
			type: "jspsych-RDK", 
			timing_post_trial: 0, //The Inter Trial Interval. You can either have no ITI, or change the display element to be the same color as the stimuli background 
			number_of_dots: 200, //Total number of dots in the aperture
			RDK_type: 3, //The type of RDK used
			choices: ["a", "l"], //Choices available to be keyed in by participant
			trial_duration: 1000, //Duration of each trial in ms
			timeline: all_trials 
		}
		
		
		
		//---------Prepare the main timeline---------
		
		//The main timeline to be fed into jsPsych.init
		var main_timeline = [];
		main_timeline.push(instructions_block);
		main_timeline.push(test_block);
		
		
		
		//---------Run the experiment---------
		
		//Initiate the experiment
		jsPsych.init({
			timeline: main_timeline,
			on_finish: function(){ //Execute this when the function finishes
				jsPsych.data.localSave('testSave.csv', 'csv'); //Save the data locally in a .csv file
				jsPsych.data.displayData();
			}
		})
		
	</script>
</html>